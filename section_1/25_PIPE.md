# راهنمای کامل و جامع برای Pipe (`|`) در Bash

**Pipe**، که با نماد `|` نمایش داده می‌شود، یکی از قابلیت‌های مهم در Bash است که به شما امکان می‌دهد خروجی یک دستور را به عنوان ورودی دستور دیگر استفاده کنید. با Pipe می‌توان دستورات مختلف را به هم متصل کرده و زنجیره‌هایی از پردازش‌های داده را به سادگی و کارآمد ایجاد کرد. Pipe برای پردازش داده‌ها، فیلتر کردن خروجی‌ها و ایجاد دستورات پیچیده‌تر مفید است.

## اهمیت Pipe در Bash

1. **پردازش زنجیره‌ای داده‌ها**: Pipe امکان ارسال خروجی یک دستور به دستور دیگر را فراهم می‌کند و از این طریق پردازش‌های زنجیره‌ای ایجاد می‌شود.
2. **کاهش استفاده از فایل‌های موقت**: به جای ذخیره خروجی یک دستور در یک فایل و سپس خواندن آن توسط دستور بعدی، Pipe به شما امکان می‌دهد که داده‌ها را مستقیماً از یک دستور به دستور دیگر منتقل کنید.
3. **ساده‌سازی کدنویسی**: استفاده از Pipe کد را کوتاه‌تر و خواناتر می‌کند، زیرا نیاز به فایل‌های موقت را کاهش می‌دهد.

---

## نحو کلی استفاده از Pipe

برای استفاده از Pipe کافی است `|` را بین دو دستور قرار دهید.

```bash
command1 | command2
```

- **`command1`**: دستوری که خروجی آن به عنوان ورودی دستور بعدی ارسال می‌شود.
- **`command2`**: دستوری که خروجی `command1` را دریافت و پردازش می‌کند.

---

## مثال‌های کاربردی Pipe در Bash

### 1. فیلتر کردن خروجی با `grep`

```bash
ps aux | grep "bash"
```

این دستور لیستی از فرآیندهای در حال اجرا را دریافت کرده و با `grep` فقط فرآیندهای مرتبط با `bash` را نمایش می‌دهد.

### 2. شمارش تعداد فایل‌ها در دایرکتوری با `wc`

```bash
ls | wc -l
```

در این مثال، خروجی دستور `ls` (فهرست فایل‌ها و دایرکتوری‌ها) به `wc -l` ارسال می‌شود تا تعداد فایل‌ها شمارش شود.

### 3. مرتب‌سازی خروجی با `sort`

```bash
cat file.txt | sort
```

این دستور محتوای فایل `file.txt` را دریافت کرده و آن را به ترتیب حروف الفبا مرتب می‌کند.

### 4. حذف موارد تکراری با `uniq`

```bash
cat file.txt | sort | uniq
```

در اینجا محتوای فایل `file.txt` پس از مرتب‌سازی با `uniq` پردازش می‌شود تا تکراری‌ها حذف شوند.

### 5. ترکیب چندین Pipe برای پردازش پیچیده‌تر

```bash
ps aux | grep "apache" | awk '{print $2}' | xargs kill -9
```

این دستور فرآیندهای مربوط به `apache` را پیدا کرده، شناسه فرآیند آن‌ها را استخراج کرده و آن‌ها را متوقف می‌کند.

---

## ابزارهای متداول برای استفاده با Pipe

در ترکیب با Pipe، چند ابزار متداول در Bash وجود دارند که برای پردازش داده‌ها و ایجاد زنجیره‌های قدرتمند به کار می‌روند:

- **`grep`**: برای فیلتر کردن متن و خروجی‌ها.
- **`sort`**: برای مرتب‌سازی.
- **`uniq`**: برای حذف تکراری‌ها.
- **`wc`**: برای شمارش خطوط، کلمات یا کاراکترها.
- **`cut`**: برای جداسازی ستون‌ها و بخش‌های خاص.
- **`awk`**: برای پردازش و استخراج بخش‌هایی از متن.
- **`sed`**: برای ویرایش رشته‌ها و جایگزینی متن.

---

## مثال‌های بیشتر با ابزارهای متداول Pipe

### ترکیب `grep` و `wc` برای شمارش نتایج

```bash
dmesg | grep "error" | wc -l
```

این دستور تعداد خطوطی که حاوی کلمه "error" در خروجی `dmesg` هستند را شمارش می‌کند.

### استخراج ستون‌ها با `cut`

```bash
ls -l | cut -d ' ' -f 5
```

این دستور اندازه فایل‌ها را از خروجی `ls -l` استخراج می‌کند (ستون پنجم حاوی اندازه فایل است).

### جایگزینی متن با `sed`

```bash
cat file.txt | sed 's/old/new/g'
```

این دستور در فایل `file.txt` هر کلمه `old` را با `new` جایگزین می‌کند.

---

## مفهوم جریان داده‌ها در Pipe

با استفاده از Pipe، داده‌ها به صورت جریان‌یافته از یک دستور به دستور دیگر منتقل می‌شوند. این جریان داده‌ها به شما امکان می‌دهد تا بدون ذخیره داده‌ها در فایل‌های موقت، به سرعت خروجی یک دستور را به عنوان ورودی دستور دیگر ارسال کنید.

### دیاگرام جریان داده‌ها با Pipe

```mermaid
graph LR
    A[command1] -->|output| B[command2]
    B -->|output| C[command3]
    C -->|output| D[command4]
```

در این دیاگرام، داده‌ها از `command1` به `command2`، سپس به `command3` و در نهایت به `command4` منتقل می‌شوند. هر دستور خروجی خود را به دستور بعدی ارسال می‌کند.

---

## نکات و ترفندهای پیشرفته برای استفاده از Pipe در Bash

1. **استفاده از `tee` برای ذخیره خروجی و پردازش همزمان**: اگر می‌خواهید خروجی یک دستور را هم در یک فایل ذخیره کنید و هم به دستور دیگری ارسال کنید، می‌توانید از `tee` استفاده کنید.

   ```bash
   ls -l | tee output.txt | grep ".txt"
   ```

2. **Pipe زنجیره‌ای با چندین دستور**: می‌توانید چندین دستور را به صورت زنجیره‌ای با Pipe ترکیب کنید.

   ```bash
   cat file.txt | grep "example" | sort | uniq | wc -l
   ```

3. **استفاده از Subshell برای ترکیب Pipeها**: می‌توانید از Subshellها برای اجرای چندین دستور با Pipe در یک ترکیب استفاده کنید.

   ```bash
   (ls -l | grep ".txt") | wc -l
   ```

4. **ترکیب Pipe با شرایط و حلقه‌ها**: می‌توانید Pipeها را با شرایط و حلقه‌ها ترکیب کنید.

   ```bash
   for file in *.txt; do
       cat "$file" | grep "pattern"
   done
   ```

5. **استفاده از `xargs` برای اجرای دستورات روی خروجی Pipe**: `xargs` به شما امکان می‌دهد که خروجی یک دستور را به عنوان آرگومان‌های دستور دیگر استفاده کنید.

   ```bash
   ls *.log | xargs rm
   ```

   در این مثال، تمامی فایل‌های با پسوند `.log` که توسط `ls` فهرست شده‌اند، با `rm` حذف می‌شوند.

---

## مزایا و معایب استفاده از Pipe در Bash

### مزایا

- **کاهش نیاز به فایل‌های موقت**: استفاده از Pipe نیاز به ذخیره‌سازی داده‌ها در فایل‌های موقت را کاهش می‌دهد.
- **افزایش کارایی و سرعت پردازش**: اجرای زنجیره‌ای و موازی دستورات به بهبود کارایی سیستم کمک می‌کند.
- **انعطاف‌پذیری در پردازش داده‌ها**: Pipe امکان ترکیب دستورات مختلف را برای پردازش‌های پیچیده‌تر فراهم می‌کند.

### معایب

- **کاهش خوانایی کد**: استفاده بیش از حد از Pipe می‌تواند کد را پیچیده و سخت‌خوان کند.
- **محدودیت در اجرای برخی دستورات**: برخی دستورات ممکن است نیاز به ورودی و خروجی خاصی داشته باشند که استفاده از Pipe را محدود می‌کند.

---

## جمع‌بندی

Pipe یکی از قابلیت‌های کلیدی در Bash است که به شما امکان می‌دهد تا با ترکیب دستورات، زنجیره‌های پردازشی ایجاد کرده و داده‌ها را به صورت موثر پردازش کنید. این قابلیت برای مدیریت فایل‌ها، فیلتر کردن و پردازش متن، و ایجاد پردازش‌های پیچیده بسیار مفید است. در این مستند، با نحو استفاده از Pipe، ابزارهای مفید همراه آن و نکات و ترفندهای پیشرفته آشنا شدید.

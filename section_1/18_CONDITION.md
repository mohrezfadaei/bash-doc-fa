# راهنمای جامع و کامل برای `if`، `switch case` و `select` در Bash

در Bash، برای کنترل جریان برنامه از ساختارهای مختلفی مانند `if`، `case` (که به عنوان switch case عمل می‌کند) و `select` استفاده می‌شود. این ساختارها به شما این امکان را می‌دهند که بر اساس شرایط مختلف، تصمیمات منطقی بگیرید و اجرای کد را کنترل کنید.

## 1. ساختار `if` در Bash

### 1.1. ساختار کلی `if`

`if` یکی از پرکاربردترین عبارات کنترلی در Bash است که برای ارزیابی شرایط و انجام عملیات‌های خاص بر اساس نتیجه آن شرایط استفاده می‌شود.

### ساختار کلی:

```bash
if [ شرط ]; then
  دستوراتی که باید در صورت صحیح بودن شرط اجرا شوند
elif [ شرط دیگر ]; then
  دستوراتی که باید در صورت صحیح بودن شرط دیگر اجرا شوند
else
  دستوراتی که باید در صورت نادرست بودن همه شرایط اجرا شوند
fi
```

### مثال:

```bash
#!/bin/bash

age=25

if [ $age -lt 18 ]; then
  echo "شما زیر 18 سال دارید."
elif [ $age -ge 18 ] && [ $age -lt 30 ]; then
  echo "شما بین 18 تا 29 سال دارید."
else
  echo "شما 30 سال یا بیشتر دارید."
fi
```

### 1.2. عملگرهای منطقی در `if`

| عملگر  | توضیحات                 | مثال استفاده                      |
| ------ | ----------------------- | --------------------------------- |
| `-eq`  | برابر بودن دو عدد       | `[ $x -eq 10 ]`                   |
| `-ne`  | نابرابر بودن دو عدد     | `[ $x -ne 20 ]`                   |
| `-lt`  | کوچکتر بودن از          | `[ $x -lt 5 ]`                    |
| `-le`  | کوچکتر یا برابر بودن از | `[ $x -le 8 ]`                    |
| `-gt`  | بزرگتر بودن از          | `[ $x -gt 3 ]`                    |
| `-ge`  | بزرگتر یا برابر بودن از | `[ $x -ge 7 ]`                    |
| `&&`   | و (AND)                 | `[ $x -gt 5 ] && [ $x -lt 10 ]`   |
| `\|\|` | یا (OR)                 | `[ $x -lt 5 ] \|\| [ $x -gt 10 ]` |
| `!`    | نقیض (NOT)              | `[ ! -f "/path/to/file" ]`        |

## 2. ساختار `case` در Bash

### 2.1. ساختار کلی `case`

ساختار `case` در Bash مشابه `switch case` در زبان‌های دیگر مانند C یا Java است. این ساختار برای بررسی چندین شرط مختلف و انجام عملیات خاص بر اساس مقدار یک متغیر استفاده می‌شود.

### ساختار کلی:

```bash
case variable in
  pattern1)
    دستورات در صورت مطابقت با pattern1
    ;;
  pattern2)
    دستورات در صورت مطابقت با pattern2
    ;;
  *)
    دستورات پیش‌فرض در صورت عدم مطابقت با هیچ کدام
    ;;
esac
```

### مثال:

```bash
#!/bin/bash

read -p "یک روز هفته را وارد کنید (مثلاً Monday): " day

case $day in
  "Monday")
    echo "روز دوشنبه است."
    ;;
  "Friday")
    echo "روز جمعه است."
    ;;
  "Sunday")
    echo "روز یکشنبه است."
    ;;
  *)
    echo "روز وارد شده معتبر نیست."
    ;;
esac
```

### 2.2. عملگرهای مقایسه در `case`

- **`*`**: مطابقت با هر مقداری (Wildcard)
- **`|`**: برای ترکیب چند الگو در یک شرط
- **`?`**: مطابقت با یک کاراکتر تکی

### مثال‌های پیشرفته:

#### ترکیب چند شرط:

```bash
#!/bin/bash

read -p "یک حرف یا عدد وارد کنید: " input

case $input in
  [0-9])
    echo "شما یک عدد وارد کردید."
    ;;
  [a-zA-Z])
    echo "شما یک حرف وارد کردید."
    ;;
  *)
    echo "ورودی نامعتبر است."
    ;;
esac
```

## 3. ساختار `select` در Bash

### 3.1. ساختار کلی `select`

ساختار `select` در Bash برای ایجاد منوهای تعاملی استفاده می‌شود. این ساختار به شما امکان می‌دهد تا از کاربران ورودی بگیرید و بر اساس انتخاب آن‌ها عملیاتی را انجام دهید.

### ساختار کلی:

```bash
select variable in option1 option2 option3; do
  دستوراتی که باید بر اساس انتخاب انجام شوند
  break
done
```

### مثال:

```bash
#!/bin/bash

PS3="لطفاً یک گزینه انتخاب کنید: "

select fruit in "Apple" "Banana" "Cherry" "Quit"; do
  case $fruit in
    "Apple")
      echo "شما سیب را انتخاب کردید."
      ;;
    "Banana")
      echo "شما موز را انتخاب کردید."
      ;;
    "Cherry")
      echo "شما گیلاس را انتخاب کردید."
      ;;
    "Quit")
      echo "خروج از برنامه."
      break
      ;;
    *)
      echo "گزینه نامعتبر است."
      ;;
  esac
done
```

### 3.2. توضیح گزینه‌های `select`

- **`PS3`**: متغیری که پیام پیش‌فرض برای منوی `select` را تعیین می‌کند.
- **`break`**: برای خروج از حلقه `select`.

## مقایسه ویژگی‌های `if`، `case` و `select`

| ویژگی                   | `if`                                       | `case`                            | `select`                            |
| ----------------------- | ------------------------------------------ | --------------------------------- | ----------------------------------- |
| نوع عملیات              | بررسی شرایط خاص (عدد، رشته، فایل و ...)    | بررسی شرایط بر اساس الگوهای مختلف | ایجاد منوهای تعاملی                 |
| سطح پیچیدگی             | ساده تا پیچیده                             | ساده برای چندین شرط متفاوت        | مناسب برای ورودی‌های تعاملی         |
| نحوه عملکرد             | ارزیابی شرطی با عملگرهای منطقی و مقایسه‌ای | بررسی الگوها و انجام عملیات       | نمایش منو و گرفتن ورودی از کاربر    |
| مناسب برای              | کنترل دقیق شرایط                           | مطابقت با الگوهای خاص             | ساخت منوها و انتخاب از بین گزینه‌ها |
| قابلیت استفاده از regex | خیر                                        | بله                               | خیر                                 |

## نکات و ترفندها

### 1. بررسی چند شرط با `if`

شما می‌توانید چندین شرط را با استفاده از عملگرهای منطقی `&&` و `||` در یک دستور `if` ترکیب کنید.

#### مثال:

```bash
#!/bin/bash
if [ -d "/path/to/dir" ] && [ -w "/path/to/file" ]; then
  echo "دایرکتوری موجود است و فایل نوشتنی است."
fi
```

### 2. استفاده از Wildcard در `case`

در `case` می‌توانید از wildcard (`*`) برای مطابقت با هر مقداری استفاده کنید.

#### مثال:

```bash
case $input in
  *.txt)
    echo "این یک فایل متنی است."
    ;;
  *.jpg|*.png)
    echo "این یک فایل تصویر است."
    ;;
  *)
    echo "فرمت فایل ناشناخته است."
    ;;
esac
```

### 3. شخصی‌سازی منوی `select` با `PS3`

با تنظیم مقدار متغیر `PS3` می‌توانید پیام ورودی را برای کاربر شخصی‌سازی کنید.

#### مثال:

```bash
PS3="لطفاً یک عدد انتخاب کنید: "
```

### 4. خروج از `select` با `break`

برای خاتمه اجرای منوی `select` از دستور `break` استفاده کنید تا از حلقه خارج شوید.

#### مثال:

```bash
if [ "$fruit" == "Quit" ]; then
  break
fi
```

## جمع‌بندی

در این راهنما به‌صورت جامع به بررسی ساختارهای کنترلی `if`، `case` و `select` در Bash پرداختیم. این ساختارها ابزارهای قدرتمندی برای مدیریت جریان برنامه و تصمیم‌گیری بر اساس شرایط مختلف هستند. با استفاده از این ابزارها، شما می‌توانید اسکریپت‌های Bash خود را به‌شکل حرفه‌ای‌تر و کارآمدتری طراحی کنید.

### جدول خلاصه ساختارهای کنترلی در Bash

| ساختار   | کاربرد اصلی                            | مثال ساده                                         |
| -------- | -------------------------------------- | ------------------------------------------------- |
| `if`     | بررسی شرایط خاص با استفاده از عملگرها  | `[ $x -gt 10 ]`                                   |
| `case`   | بررسی الگوهای مختلف و انجام عملیات خاص | `case $var in "pattern1") ... ;;`                 |
| `select` | ایجاد منوهای تعاملی برای ورودی کاربر   | `select var in "Option1" "Option2"; do ...; done` |

## مثال

در مثال زیر یک برنامه CLI نوشته شده است:

```bash
#!/bin/bash

# برنامه مدیریت کتابخانه

declare -A library  # آرایه مرتبط برای ذخیره اطلاعات کتاب‌ها

# تابع برای نمایش منو
show_menu() {
    echo "-----------------------------"
    echo "مدیریت کتابخانه"
    echo "1. اضافه کردن کتاب"
    echo "2. نمایش کتاب‌ها"
    echo "3. جستجوی کتاب"
    echo "4. حذف کتاب"
    echo "5. خروج"
    echo "-----------------------------"
}

# تابع برای اضافه کردن کتاب
add_book() {
    read -p "عنوان کتاب را وارد کنید: " title
    read -p "نویسنده کتاب را وارد کنید: " author
    library["$title"]="$author"
    echo "کتاب '$title' با نویسنده '$author' به کتابخانه اضافه شد."
}

# تابع برای نمایش کتاب‌ها
show_books() {
    if [ ${#library[@]} -eq 0 ]; then
        echo "هیچ کتابی در کتابخانه وجود ندارد."
    else
        echo "کتاب‌های موجود در کتابخانه:"
        for title in "${!library[@]}"; do
            echo "- عنوان: $title، نویسنده: ${library[$title]}"
        done
    fi
}

# تابع برای جستجوی کتاب
search_book() {
    read -p "عنوان کتابی که می‌خواهید جستجو کنید را وارد کنید: " title
    if [[ -n "${library[$title]}" ]]; then
        echo "کتاب '$title' با نویسنده '${library[$title]}' یافت شد."
    else
        echo "کتاب '$title' در کتابخانه موجود نیست."
    fi
}

# تابع برای حذف کتاب
remove_book() {
    read -p "عنوان کتابی که می‌خواهید حذف کنید را وارد کنید: " title
    if [[ -n "${library[$title]}" ]]; then
        unset library["$title"]
        echo "کتاب '$title' از کتابخانه حذف شد."
    else
        echo "کتاب '$title' در کتابخانه موجود نیست."
    fi
}

# حلقه اصلی برنامه
while true; do
    show_menu
    read -p "لطفاً گزینه مورد نظر خود را انتخاب کنید: " choice

    case $choice in
        1)
            add_book
            ;;
        2)
            show_books
            ;;
        3)
            search_book
            ;;
        4)
            remove_book
            ;;
        5)
            echo "خروج از برنامه."
            break
            ;;
        *)
            echo "گزینه نامعتبر است. لطفاً دوباره تلاش کنید."
            ;;
    esac
done
```

### توضیحات برنامه:

1. **آرایه مرتبط**: از یک آرایه مرتبط به نام `library` برای ذخیره عنوان و نویسنده کتاب‌ها استفاده شده است.

2. **منو**: با استفاده از یک تابع `show_menu`، منوی مدیریتی برای برنامه نمایش داده می‌شود که گزینه‌های مختلف را به کاربر ارائه می‌دهد.

3. **عملیات‌ها**:

   - **اضافه کردن کتاب**: با استفاده از تابع `add_book`، کاربر می‌تواند عنوان و نویسنده کتاب را وارد کند.
   - **نمایش کتاب‌ها**: با استفاده از تابع `show_books`، تمام کتاب‌های موجود در کتابخانه نمایش داده می‌شود.
   - **جستجوی کتاب**: با استفاده از تابع `search_book`، کاربر می‌تواند کتاب مورد نظر را جستجو کند.
   - **حذف کتاب**: با استفاده از تابع `remove_book`، کاربر می‌تواند کتابی را از کتابخانه حذف کند.

4. **حلقه اصلی**: این حلقه از `while true` استفاده می‌کند تا برنامه به طور مداوم منو را نمایش دهد تا کاربر گزینه‌ها را انتخاب کند و عملیات مورد نظر خود را انجام دهد.

5. **استفاده از `case`**: برای مدیریت انتخاب‌های کاربر از دستور `case` استفاده شده است.

# آموزش استفاده از دستور `declare` در Bash

دستور `declare` یکی از دستورات قدرتمند در Bash است که به شما امکان می‌دهد متغیرها را با ویژگی‌های خاصی تعریف و مدیریت کنید. این دستور به شما اجازه می‌دهد که نوع متغیرها را مشخص کرده، آنها را به صورت فقط خواندنی (`readonly`) تعریف کرده و حتی آرایه‌ها را مدیریت کنید.

در این راهنما، نحوه استفاده از `declare` و گزینه‌های مختلف آن را توضیح خواهیم داد.

## ساختار کلی `declare`

ساختار کلی استفاده از `declare` به این صورت است:

```bash
declare [OPTION] variable_name
```

- **`[OPTION]`**: گزینه‌هایی که ویژگی‌های خاصی به متغیر اختصاص می‌دهند (مثلاً تعریف متغیر فقط خواندنی، عدد صحیح و غیره).
- **`variable_name`**: نام متغیری که تعریف می‌کنید.

## 1. تعریف متغیرهای محلی با `declare -l`

یکی از کاربردهای اصلی `declare` تعریف متغیرهای محلی است که فقط در محدوده یک تابع قابل دسترسی باشند. برای تعریف یک متغیر محلی از گزینه `-l` استفاده می‌شود:

```bash
function my_function {
    declare -l local_var="Hello, Local"
    echo "$local_var"
}
my_function
```

### نکته:

- متغیرهای محلی تنها در محدوده تابعی که در آن تعریف شده‌اند وجود دارند و خارج از آن تابع قابل دسترسی نیستند.

## 2. تعریف متغیرهای فقط خواندنی (Readonly) با `declare -r`

با استفاده از `declare -r` می‌توانید متغیرهایی تعریف کنید که پس از مقداردهی قابل تغییر نیستند. این متغیرها به عنوان متغیرهای فقط خواندنی شناخته می‌شوند.

### مثال:

```bash
declare -r PI=3.14
echo $PI
PI=3.14159  # خطا: تلاش برای تغییر مقدار متغیر فقط خواندنی
```

### نکته:

- متغیرهای فقط خواندنی برای ثابت‌ها و مقادیر مهمی که نباید تغییر کنند مناسب هستند.

## 3. تعریف متغیرهای عدد صحیح با `declare -i`

اگر می‌خواهید متغیری فقط اعداد صحیح را قبول کند و به طور خودکار محاسبات ریاضی انجام شود، از گزینه `-i` استفاده کنید.

### مثال:

```bash
declare -i COUNT=5
COUNT=$((COUNT + 10))  # اضافه کردن عدد
echo $COUNT  # خروجی: 15
```

### نکته:

- متغیرهای عدد صحیح از محاسبات ریاضی به طور خودکار پشتیبانی می‌کنند و اگر مقداری غیرعددی به آن اختصاص داده شود، نادیده گرفته می‌شود.

## 4. تعریف آرایه‌ها با `declare -a`

برای تعریف یک آرایه می‌توانید از گزینه `-a` استفاده کنید. آرایه‌ها به شما این امکان را می‌دهند که چندین مقدار را در یک متغیر نگه دارید.

### مثال:

```bash
declare -a fruits=("Apple" "Banana" "Cherry")
echo "${fruits[0]}"  # دسترسی به عنصر اول
```

### نکته:

- با استفاده از `${fruits[@]}` می‌توانید به تمام عناصر آرایه دسترسی پیدا کنید.

### افزودن عنصر جدید به آرایه:

```bash
fruits[3]="Orange"
```

## 5. تعریف آرایه‌های مرتبط با `declare -A`

آرایه‌های مرتبط یا associative arrays به شما این امکان را می‌دهند که از کلیدهای غیر عددی برای دسترسی به عناصر استفاده کنید. برای تعریف این نوع آرایه‌ها از گزینه `-A` استفاده می‌شود.

### مثال:

```bash
declare -A capital
capital[France]="Paris"
capital[Germany]="Berlin"
capital[Italy]="Rome"

echo "Capital of France: ${capital[France]}"
```

### نکته:

- آرایه‌های مرتبط از Bash 4.0 به بعد پشتیبانی می‌شوند.

## 6. نمایش نوع متغیرها با `declare -p`

برای مشاهده نوع متغیر و مقدار آن می‌توانید از گزینه `-p` استفاده کنید. این دستور اطلاعات مربوط به متغیر را چاپ می‌کند.

### مثال:

```bash
declare -i num=10
declare -p num  # خروجی: declare -i num="10"
```

### نکته:

- این دستور مفید است زمانی که می‌خواهید نوع و ویژگی‌های متغیرها را در اسکریپت‌های خود بررسی کنید.

## 7. تبدیل رشته به حروف کوچک یا بزرگ با `declare -l` و `declare -u`

با استفاده از `declare -l` می‌توانید یک رشته را به طور خودکار به حروف کوچک تبدیل کنید و با `declare -u` می‌توانید آن را به حروف بزرگ تبدیل کنید.

### مثال:

- **تبدیل به حروف کوچک**:

```bash
declare -l my_var="HELLO"
echo $my_var  # خروجی: hello
```

- **تبدیل به حروف بزرگ**:

```bash
declare -u my_var="hello"
echo $my_var  # خروجی: HELLO
```

## 8. استفاده از `declare` در توابع

با استفاده از `declare` می‌توانید متغیرهای محلی داخل توابع تعریف کنید که فقط در محدوده آن تابع قابل استفاده هستند.

### مثال:

```bash
my_function() {
    declare -i local_var=10
    echo "Local variable: $local_var"
}

my_function
echo "Trying to access local_var: $local_var"  # local_var در خارج از تابع در دسترس نیست
```

### نکته:

- متغیرهایی که با `declare` در توابع تعریف می‌شوند، فقط در همان تابع معتبر هستند.

## 9. بررسی اینکه آیا متغیرها قبلاً تعریف شده‌اند با `declare -p`

با استفاده از `declare -p` می‌توانید بررسی کنید که آیا متغیرها قبلاً تعریف شده‌اند یا نه.

### مثال:

```bash
if declare -p my_var > /dev/null 2>&1; then
    echo "my_var is already defined."
else
    echo "my_var is not defined."
fi
```

## جمع‌بندی

دستور `declare` در Bash ابزار قدرتمندی برای تعریف و مدیریت متغیرها با ویژگی‌های خاص است. این دستور به شما اجازه می‌دهد متغیرهایی با ویژگی‌های مشخص مانند فقط خواندنی، عدد صحیح، آرایه‌ای و محلی تعریف کنید. همچنین می‌توانید متغیرها را به صورت رشته‌های حروف بزرگ یا کوچک تعریف کنید و نوع متغیرها را به راحتی بررسی کنید.

### نکات کلیدی:

- **`declare -r`**: برای تعریف متغیرهای فقط خواندنی.
- **`declare -i`**: برای تعریف متغیرهای عدد صحیح.
- **`declare -a`**: برای تعریف آرایه‌ها.
- **`declare -A`**: برای تعریف آرایه‌های مرتبط.
- **`declare -l` و `declare -u`**: برای تبدیل خودکار به حروف کوچک یا بزرگ.

با تسلط بر این دستور، می‌توانید اسکریپت‌های Bash خود را کارآمدتر و قابل مدیریت‌تر بنویسید.

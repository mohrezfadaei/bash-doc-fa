# راهنمای جامع و کامل حلقه `for` در Bash

حلقه `for` در Bash یکی از پرکاربردترین و منعطف‌ترین ابزارها برای تکرار و پیمایش داده‌ها است. این حلقه به شما اجازه می‌دهد تا به‌سادگی از میان لیستی از مقادیر، آرایه‌ها، فایل‌ها و حتی نتایج دستورات مختلف عبور کرده و عملیات مورد نظر خود را روی هر عنصر اجرا کنید. در این مستند، به بررسی کامل ساختار حلقه `for`، گزینه‌های مختلف آن، و نکات و ترفندهای کار با این حلقه خواهیم پرداخت.

## 1. ساختار کلی حلقه `for`

حلقه `for` در Bash به دو صورت استفاده می‌شود:

### 1.1. `for` ساده

در این حالت، حلقه بر روی لیستی از مقادیر کار می‌کند و برای هر مقدار یک بار بدنه حلقه اجرا می‌شود.

### ساختار کلی:

```bash
for variable in list; do
  دستورات برای هر مقدار
done
```

### مثال ساده:

```bash
#!/bin/bash
for fruit in apple banana cherry; do
  echo "میوه: $fruit"
done
```

در این مثال، برای هر مقدار از لیست (apple, banana, cherry)، حلقه یک بار اجرا شده و مقدار درون متغیر `fruit` قرار می‌گیرد.

### 1.2. حلقه `for` با شمارش

این روش حلقه زدن مشابه حلقه‌های شمارشی در زبان‌های دیگر است. با استفاده از این روش، یک شمارنده تعریف شده و مقدار آن در هر دور از حلقه تغییر می‌کند.

### ساختار کلی:

```bash
for (( initializer; condition; increment )); do
  دستورات
done
```

### مثال:

```bash
#!/bin/bash
for (( i=1; i<=5; i++ )); do
  echo "عدد: $i"
done
```

در این مثال، حلقه از مقدار `i=1` شروع می‌کند و تا زمانی که `i` کمتر یا برابر با 5 باشد، ادامه می‌یابد. در هر دور، مقدار `i` یک واحد افزایش می‌یابد.

## 2. روش‌های مختلف استفاده از `for`

### 2.1. پیمایش آرایه‌ها

حلقه `for` برای پیمایش آرایه‌ها به کار می‌رود. شما می‌توانید به‌راحتی عناصر یک آرایه را با استفاده از این حلقه پردازش کنید.

#### مثال:

```bash
#!/bin/bash
fruits=("apple" "banana" "cherry")

for fruit in "${fruits[@]}"; do
  echo "میوه: $fruit"
done
```

### 2.2. استفاده از نتایج دستورات

می‌توانید از خروجی یک دستور Bash به عنوان لیست مقادیر درون حلقه `for` استفاده کنید.

#### مثال:

```bash
#!/bin/bash
for file in $(ls /home/user); do
  echo "فایل: $file"
done
```

در این مثال، خروجی دستور `ls` به عنوان لیستی از مقادیر در حلقه `for` استفاده شده و هر فایل درون متغیر `file` قرار می‌گیرد.

### 2.3. پیمایش فایل‌ها در یک دایرکتوری

با استفاده از `for`، می‌توانید فایل‌های یک دایرکتوری خاص را پیمایش کنید.

#### مثال:

```bash
#!/bin/bash
for file in /home/user/*; do
  echo "فایل: $file"
done
```

### 2.4. استفاده از `C-style for loop`

این روش شبیه به حلقه‌های شمارشی در زبان‌هایی مانند C یا Java است. در این نوع حلقه، سه بخش (مقداردهی اولیه، شرط، و افزایش) تعریف می‌شود.

#### مثال:

```bash
#!/bin/bash
for (( i=0; i<10; i++ )); do
  echo "عدد: $i"
done
```

## 3. استفاده از `break` و `continue` در حلقه `for`

### 3.1. `break`

دستور `break` برای خاتمه دادن زودهنگام به اجرای حلقه استفاده می‌شود. وقتی این دستور اجرا شود، حلقه بلافاصله متوقف می‌شود و اجرای برنامه از دستور بعد از حلقه ادامه می‌یابد.

#### مثال:

```bash
#!/bin/bash
for (( i=1; i<=5; i++ )); do
  if [ $i -eq 3 ]; then
    break
  fi
  echo "عدد: $i"
done
```

در این مثال، وقتی `i` برابر با 3 شود، حلقه متوقف می‌شود و اعداد 1 و 2 چاپ می‌شوند.

### 3.2. `continue`

دستور `continue` باعث می‌شود که اجرای دستورات باقی‌مانده درون حلقه نادیده گرفته شده و اجرای حلقه از دور بعدی ادامه یابد.

#### مثال:

```bash
#!/bin/bash
for (( i=1; i<=5; i++ )); do
  if [ $i -eq 3 ]; then
    continue
  fi
  echo "عدد: $i"
done
```

در این مثال، وقتی `i` برابر با 3 شود، دستور `continue` اجرا می‌شود و از چاپ عدد 3 جلوگیری می‌شود. اعداد 1، 2، 4 و 5 چاپ می‌شوند.

## 4. ترفندها و نکات پیشرفته در حلقه `for`

### 4.1. استفاده از IFS برای پردازش لیست‌های خاص

IFS (Internal Field Separator) متغیری است که جداکننده فیلدها در Bash را تعیین می‌کند. برای مثال، می‌توانید از IFS برای پردازش لیست‌هایی که با کاراکترهایی مانند کاما یا نقطه‌ویرگول جدا شده‌اند استفاده کنید.

#### مثال:

```bash
#!/bin/bash
IFS=','  # جداکننده فیلدها را به کاما تغییر می‌دهیم
list="apple,banana,cherry"

for fruit in $list; do
  echo "میوه: $fruit"
done
```

### 4.2. استفاده از حلقه‌های تو در تو (Nested Loops)

در Bash، می‌توانید حلقه‌های `for` تو در تو (nested) بنویسید تا عملیات پیچیده‌تری انجام دهید.

#### مثال:

```bash
#!/bin/bash
for i in {1..3}; do
  for j in {A..C}; do
    echo "ترکیب: $i$j"
  done
done
```

### 4.3. استفاده از Range برای تولید لیست‌ها

می‌توانید با استفاده از ساختار‌های مانند `{start..end}` به‌راحتی یک لیست از اعداد یا کاراکترها تولید کرده و درون حلقه `for` از آن‌ها استفاده کنید.

#### مثال:

```bash
#!/bin/bash
for number in {1..10}; do
  echo "عدد: $number"
done
```

### 4.4. حلقه‌های بی‌نهایت

با استفاده از ساختار `for`، می‌توانید یک حلقه بی‌نهایت ایجاد کنید که تا زمانی که به‌صورت دستی متوقف نشود ادامه پیدا کند.

#### مثال:

```bash
#!/bin/bash
for (( ;; )); do
  echo "این حلقه بی‌نهایت است."
done
```

برای متوقف کردن چنین حلقه‌ای می‌توانید از `break` یا سیگنال‌های کنترل مانند Ctrl+C استفاده کنید.

## 5. جدول مقایسه روش‌های مختلف استفاده از `for`

| روش                       | توضیحات                                 | مثال                               |
| ------------------------- | --------------------------------------- | ---------------------------------- |
| `for variable in list`    | پیمایش یک لیست از مقادیر                | `for fruit in apple banana cherry` |
| `for (( i=0; i<N; i++ ))` | حلقه شمارشی با شرط و افزایش             | `for (( i=0; i<10; i++ ))`         |
| پیمایش آرایه‌ها           | پیمایش عناصر یک آرایه                   | `for item in "${array[@]}"`        |
| خروجی دستور               | استفاده از خروجی یک دستور به‌عنوان لیست | `for file in $(ls /path)`          |
| حلقه بی‌نهایت             | تکرار بدون توقف تا زمانی که متوقف شود   | `for (( ;; ))`                     |

## جمع‌بندی

حلقه `for` در Bash یکی از ابزارهای قدرتمند و منعطف است که برای انجام عملیات تکراری، پردازش لیست‌ها، پیمایش آرایه‌ها و حتی خروجی دستورات استفاده می‌شود. با تسلط بر انواع مختلف حلقه‌های `for` و استفاده از ترفندها و نکات پیشرفته، می‌توانید اسکریپت‌های Bash خود را به‌صورت حرفه‌ای و کارآمدتر طراحی کنید.
